"use strict";(self.webpackChunktiny=self.webpackChunktiny||[]).push([[669],{5909:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>a,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"Hub","title":"Lightning Hub","description":"To act as a connector to your client apps, you will need either LNBits or Albyhub, in addition to your Lightning node backend.","source":"@site/docs/Hub.md","sourceDirName":".","slug":"/Hub","permalink":"/tiny-lightning-node-tutorial/Hub","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Lightning Hub","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Lightning Node","permalink":"/tiny-lightning-node-tutorial/Node"},"next":{"title":"Point-of-sale App","permalink":"/tiny-lightning-node-tutorial/point-of-sale"}}');var o=i(4848),s=i(8453);const l={title:"Lightning Hub",sidebar_position:4},r="Lightning Hub",d={},c=[{value:"LNBits",id:"lnbits",level:2},{value:"Clone the repo",id:"clone-the-repo",level:3},{value:"Install dependencies",id:"install-dependencies",level:3},{value:"Configure LNBits",id:"configure-lnbits",level:3},{value:"Systemd service",id:"systemd-service",level:3},{value:"LndHub",id:"lndhub",level:3},{value:"Install and Get Invoice QR",id:"install-and-get-invoice-qr",level:4},{value:"Turn off LNBITS_ADMIN_UI again",id:"turn-off-lnbits_admin_ui-again",level:4},{value:"Albyhub",id:"albyhub",level:2},{value:"Desktop",id:"desktop",level:3},{value:"Docker (only tested on Linux)",id:"docker-only-tested-on-linux",level:3},{value:"docker-compose (make sure to stop your old phoenixd container if you go this route)",id:"docker-compose-make-sure-to-stop-your-old-phoenixd-container-if-you-go-this-route",level:4},{value:"Configure Albyhub with your selected backend (needed for both Desktop and Docker)",id:"configure-albyhub-with-your-selected-backend-needed-for-both-desktop-and-docker",level:3}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"lightning-hub",children:"Lightning Hub"})}),"\n",(0,o.jsx)(n.p,{children:"To act as a connector to your client apps, you will need either LNBits or Albyhub, in addition to your Lightning node backend."}),"\n",(0,o.jsx)(n.p,{children:"Click to choose a Lightning Hub as your base of operations:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"#lnbits",children:(0,o.jsx)(n.strong,{children:"LNBits"})})," connects to pretty much any Lightning backend"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"#albyhub",children:(0,o.jsx)(n.strong,{children:"Albyhub"})})," connects to Phoenixd (recommended), LDK (bundled with Albyhub), and LND."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"lnbits",children:"LNBits"}),"\n",(0,o.jsx)(n.h3,{id:"clone-the-repo",children:"Clone the repo"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"mkdir -p ~/code && cd ~/code\ngit clone https://github.com/lnbits/lnbits\ncd ~/code/lnbits\n"})}),"\n",(0,o.jsx)(n.h3,{id:"install-dependencies",children:"Install dependencies"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"sudo apt install build-essential libsecp256k1-dev pkg-config python3-dev\n# install poetry\ncurl -sSL https://install.python-poetry.org | python3 -\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Make sure you copy and paste the ",(0,o.jsx)(n.code,{children:"export"})," command that poetry's installer spits out so that you can execute poetry from your current shell. If you want to be able to permanently install poetry on your system, you should append this ",(0,o.jsx)(n.code,{children:"export"})," command to your ",(0,o.jsx)(n.code,{children:"~/.bashrc"})," file. To test whether ",(0,o.jsx)(n.code,{children:"poetry"})," works, run:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"poetry --version\n"})}),"\n",(0,o.jsx)(n.p,{children:"If it worked, you now have poetry and you can move on to the next step:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"git checkout main\npoetry install --only main\n"})}),"\n",(0,o.jsx)(n.p,{children:"If Poetry hangs when doing dependency installation, the issue may be resolved by disabling keyring:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"poetry config keyring.enabled false\n"})}),"\n",(0,o.jsx)(n.h3,{id:"configure-lnbits",children:"Configure LNBits"}),"\n",(0,o.jsx)(n.p,{children:"Copy to clipboard the http-password from phoenix.conf"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"docker exec -it phoenixd cat /phoenix/.phoenix/phoenix.conf | grep http-password=\n"})}),"\n",(0,o.jsx)(n.p,{children:"Now create and edit the .env file"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"cp .env.example .env\nnano .env\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Change ",(0,o.jsx)(n.code,{children:"HOST=127.0.0.1"})," to ",(0,o.jsx)(n.code,{children:"HOST=0.0.0.0"})]}),"\n",(0,o.jsxs)(n.li,{children:["Change ",(0,o.jsx)(n.code,{children:"LNBITS_BACKEND_WALLET_CLASS=VoidWallet"})," to ",(0,o.jsx)(n.code,{children:"LNBITS_BACKEND_WALLET_CLASS=PhoenixdWallet"})]}),"\n",(0,o.jsxs)(n.li,{children:["find the ",(0,o.jsx)(n.code,{children:"# PhoenixdWallet"})," section and change the line that says ",(0,o.jsx)(n.code,{children:"PHOENIXD_API_PASSWORD=PHOENIXD_KEY"})," to ",(0,o.jsx)(n.code,{children:"PHOENIXD_API_PASSWORD=<paste your http-password>"})]}),"\n",(0,o.jsx)(n.li,{children:"Ctrl+s then Ctrl+x to save and exit"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"systemd-service",children:"Systemd service"}),"\n",(0,o.jsxs)(n.p,{children:["Follow instructions to ",(0,o.jsx)(n.a,{href:"https://github.com/lnbits/lnbits/blob/main/docs/guide/installation.md#lnbits-as-a-systemd-service",children:"install lnbits as a systemd service"})," (repeated here for your convenience):"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"sudo nano /etc/systemd/system/lnbits.service\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Copy and paste the following into the file (ctrl+shift+v to paste in linux or cmd+v on mac) (",(0,o.jsx)(n.strong,{children:'NOTE: If you\'re not using an orangepi for this tutorial, make sure to replace all occurrences of "orangepi" with your actual username below'}),"):"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"# Systemd unit for lnbits\n# /etc/systemd/system/lnbits.service\n\n[Unit]\nDescription=LNbits\n# you can uncomment these lines if you know what you're doing\n# it will make sure that lnbits starts after lnd (replace with your own backend service)\n#Wants=lnd.service\n#After=lnd.service\n\n[Service]\n# replace with the absolute path of your lnbits installation\nWorkingDirectory=/home/orangepi/code/lnbits\n# same here. run `which poetry` if you can't find the poetry binary\nExecStart=/home/orangepi/.local/bin/poetry run lnbits\n# replace with the user that you're running lnbits on\nUser=orangepi\nRestart=always\nTimeoutSec=120\nRestartSec=30\nEnvironment=PYTHONUNBUFFERED=1\n\n[Install]\nWantedBy=multi-user.target\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Ctrl+s, Ctrl+x to save and exit"}),"\n",(0,o.jsx)(n.li,{children:"Enable lnbits to run on system boot, and start:"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"sudo systemctl enable lnbits.service\nsudo systemctl start lnbits.service\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Check to make sure lnbits is connected to phoenixd. Check the logs and make sure you see ",(0,o.jsx)(n.code,{children:"PhoenixdWallet"}),", not ",(0,o.jsx)(n.code,{children:"VoidWallet"}),":"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"sudo journalctl -u lnbits -ef"})}),"\n",(0,o.jsx)(n.p,{children:"On some systems you may need this instead:"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"sudo tail -f /var/log/syslog"})}),"\n",(0,o.jsx)(n.p,{children:"Once lnbits is running and connected to phoenixd properly, you should enable the admin UI to be able to install the LNDHub extension:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"nano .env\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Change ",(0,o.jsx)(n.code,{children:"LNBITS_ADMIN_UI=false"})," to ",(0,o.jsx)(n.code,{children:"LNBITS_ADMIN_UI=true"})," (",(0,o.jsx)(n.strong,{children:"PAY ATTENTION TO THE NOTE AT THE TOP EXPLAINING THAT THE REST OF THE CONFIG IS IGNORED WHEN THIS SETTING IS ON"}),")"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Go on to the next step to install LNDHub. Once it's installed, you can deactivate the admin UI again."}),"\n",(0,o.jsx)(n.h3,{id:"lndhub",children:"LndHub"}),"\n",(0,o.jsx)(n.h4,{id:"install-and-get-invoice-qr",children:"Install and Get Invoice QR"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Log into the lnbits superuser portal in your browser (",(0,o.jsx)(n.code,{children:"http://<orangepi LAN IP, same as SSH>:5000"}),")"]}),"\n",(0,o.jsx)(n.li,{children:"Create a username and password, making sure to save your wallet link somewhere secure, like a password manager."}),"\n",(0,o.jsxs)(n.li,{children:["Click ",(0,o.jsx)(n.code,{children:"Extensions"})]}),"\n",(0,o.jsxs)(n.li,{children:["Click ",(0,o.jsx)(n.code,{children:"All"})]}),"\n",(0,o.jsx)(n.li,{children:'Search for "lndhub" in the search bar'}),"\n",(0,o.jsxs)(n.li,{children:["find the ",(0,o.jsx)(n.code,{children:"LndHub"})," extension and click ",(0,o.jsx)(n.code,{children:"Manage"})]}),"\n",(0,o.jsx)(n.li,{children:"Click the dropdown that opens and install the latest available version (0.5.0 at time of writing)"}),"\n",(0,o.jsxs)(n.li,{children:["You will be taken to the ",(0,o.jsx)(n.code,{children:"Installed"})," page"]}),"\n",(0,o.jsxs)(n.li,{children:["Click ",(0,o.jsx)(n.code,{children:"Enable"})," on the ",(0,o.jsx)(n.code,{children:"LndHub"})," extension."]}),"\n",(0,o.jsxs)(n.li,{children:["An ",(0,o.jsx)(n.code,{children:"LndHub"})," item will appear under the ",(0,o.jsx)(n.code,{children:"Extensions"})," heading on the left of your browser window. Go ahead and click it."]}),"\n",(0,o.jsx)(n.li,{children:'You will be presented with 2 QR codes. The one on the left is the "invoice URL" and the one on the right is the "admin URL". We will use the "invoice URL" to set up your point of sale device.'}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"turn-off-lnbits_admin_ui-again",children:"Turn off LNBITS_ADMIN_UI again"}),"\n",(0,o.jsx)(n.p,{children:"Once LNDHub is installed, you'll want to turn off LNBITS_ADMIN_UI again in LNBits. Go back to your terminal and edit the LNBits .env file:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"nano ~/code/lnbits/.env\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Change ",(0,o.jsx)(n.code,{children:"LNBITS_ADMIN_UI=true"})," to ",(0,o.jsx)(n.code,{children:"LNBITS_ADMIN_UI=false"})]}),"\n",(0,o.jsx)(n.p,{children:"Save and close (ctrl+s, ctrl+x)"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Now let's connect your point of sale app! (Zeus if you are using LNBits with LNDHub)"})}),"\n",(0,o.jsx)(n.h2,{id:"albyhub",children:"Albyhub"}),"\n",(0,o.jsx)(n.p,{children:"Albyhub is a quick way to get started accepting Lightning payments. In this tutorial, we will use it with one of two backends:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"LDK (bundled with Albyhub), or"}),"\n",(0,o.jsx)(n.li,{children:"Phoenixd"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"You can run albyhub in many places:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Desktop/laptop"}),"\n",(0,o.jsx)(n.li,{children:"Docker (for orangepi or vps)"}),"\n",(0,o.jsx)(n.li,{children:"Turnkey nodes like Start9 (doesn't work with phoenixd for now)"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"desktop",children:"Desktop"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Install the latest release from ",(0,o.jsx)(n.a,{href:"https://github.com/getAlby/hub/releases",children:"here"})," (",(0,o.jsx)(n.a,{href:"https://github.com/getAlby/hub/releases/tag/v1.14.2",children:"v1.14.2"})," at time of writing)","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Choose the compressed archive appropriate for your OS"}),"\n",(0,o.jsx)(n.li,{children:"Extract the archive to a convenient directory"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:['Run the "Alby Hub" binary',"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["On Linux, this is ",(0,o.jsx)(n.code,{children:"./albyhub-Desktop-Linux/albyhub-Desktop-Linux/bin/Alby\\ Hub"})," from the dir you extracted the archive in"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"docker-only-tested-on-linux",children:"Docker (only tested on Linux)"}),"\n",(0,o.jsx)(n.p,{children:"Docker makes setting up Albyhub easy!"}),"\n",(0,o.jsx)(n.h4,{id:"docker-compose-make-sure-to-stop-your-old-phoenixd-container-if-you-go-this-route",children:"docker-compose (make sure to stop your old phoenixd container if you go this route)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Great for running Albyhub and Phoenixd together."}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Install docker-compose:"}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose\nsudo chmod +x /usr/local/bin/docker-compose\n'})}),"\n",(0,o.jsx)(n.p,{children:"Create a directory for your albyhub data:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"mkdir -p albyhub && cd albyhub\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Create and populate ",(0,o.jsx)(n.code,{children:"docker-compose.yml"}),":"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Create:"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"nano docker-compose.yml\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Populate:"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'services:\n  albyhub:\n    container_name: albyhub\n    image: ghcr.io/getalby/hub:latest\n    volumes:\n      - ./albyhub-phoenixd:/data\n    ports:\n      - "8080:8080"\n    links:\n      - "albyhub-phoenixd:albyhub-phoenixd"\n    environment:\n      - WORK_DIR=/data/albyhub\n      - LOG_EVENTS=true\n\n  albyhub-phoenixd:\n    platform: linux/arm64\n    image: ghcr.io/sethforprivacy/phoenixd:latest\n    container_name: albyhub-phoenixd\n    ports:\n      - "9740:9740"\n    volumes:\n      - phoenixd_data:/phoenix\n    command: --agree-to-terms-of-service --http-bind-ip 0.0.0.0\n\nvolumes:\n  phoenixd_data:\n    external: true\n'})}),"\n",(0,o.jsx)(n.h3,{id:"configure-albyhub-with-your-selected-backend-needed-for-both-desktop-and-docker",children:"Configure Albyhub with your selected backend (needed for both Desktop and Docker)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["For LDK, just use the default","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"You will need to acquire inbound liquidity by buying an inbound channel from an LSP."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:['For Phoenixd, say "advanced" then "connect custom node" when you first go through the setup flow.',"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"You cannot change this without deleting your Albyhub data, so make sure you do it the way you want the first time."}),"\n",(0,o.jsxs)(n.li,{children:["Use ",(0,o.jsx)(n.code,{children:"http://127.0.0.1:9740"})," (or LAN IP if running on a different computer) for Desktop, and ",(0,o.jsx)(n.code,{children:"http://albyhub-phoenixd:9740"})," if running in docker-compose"]}),"\n",(0,o.jsxs)(n.li,{children:["Grab your Phoenixd ",(0,o.jsx)(n.code,{children:"http-password"})," as described in the ",(0,o.jsx)(n.a,{href:"#configure-lnbits",children:"LNBits section above"}),', then paste that into the "Authorization" field in Albyhub Desktop.']}),"\n",(0,o.jsxs)(n.li,{children:["You should have already acquired inbound when you set up ",(0,o.jsx)(n.a,{href:"node",children:"Phoenixd in the previous step"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Congrats, now you have your Lightning Hub set up!"})}),"\n",(0,o.jsx)(n.p,{children:"Read on to set up your workers' point-of-sale app!"})]})}function a(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>r});var t=i(6540);const o={},s=t.createContext(o);function l(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);